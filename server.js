var express=require("express"),helmet=require("helmet"),bodyParser=require("body-parser"),log4js=require("log4js"),morgan=require("morgan"),fs=require("fs"),path=require("path"),app=express(),port=8080;app.use(helmet());app.use(bodyParser.json());app.use(bodyParser.urlencoded({extended:!0}));app.use(express["static"](__dirname+"/webapp"));var logger;"production"===process.env.NODE_ENV?(log4js.configure(__dirname+"/config/log4js.json"),logger=log4js.getLogger("log")):logger=log4js.getLogger();
if("production"===process.env.NODE_ENV){var fileStreamRotator=require("file-stream-rotator"),logDirectory=path.join(__dirname,"log");fs.existsSync(logDirectory)||fs.mkdirSync(logDirectory);var accessLogStream=fileStreamRotator.getStream({date_format:"YYYYMMDD",filename:path.join(logDirectory,"access-%DATE%.log"),frequency:"daily",verbose:!1});app.use(morgan("combined",{stream:accessLogStream}))}else app.use(morgan("combined"));app.get("/",function(b,a){a.status(200).send("May the force be with you.")});
app.listen(port,function(){logger.info("Server run on port",port,"in",process.env.NODE_ENV,"mode")});
